<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= title || "Twitter Bridge" %></title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
<% if (!hideLayout) { %>
<div class="layout">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo">PG</div>
      <div class="title">Pansa Group</div>
    </div>
    <nav class="menu">
      <a href="/dashboard" class="item ajax-link <%= currentPath==='/dashboard'?'active':'' %>"><i class="fa fa-home"></i> Dashboard</a>
      <a href="/tweets" class="item ajax-link <%= currentPath==='/tweets'?'active':'' %>"><i class="fab fa-twitter"></i> My Tweets</a>
      <a href="/schedule" class="item ajax-link <%= currentPath==='/schedule'?'active':'' %>"><i class="fa fa-clock"></i> Scheduler</a>
      <a href="/notifications" class="item ajax-link <%= currentPath==='/notifications'?'active':'' %>"><i class="fa fa-bell"></i> Notifications</a>
      <a href="/settings" class="item ajax-link <%= currentPath.startsWith('/settings')?'active':'' %>"><i class="fa fa-cog"></i> Settings</a>
      <a href="/my-login-logs" class="item ajax-link <%= currentPath==='/my-login-logs'?'active':'' %>"><i class="fa fa-shield-alt"></i> Login Logs</a>

      <% if (sessionUser && sessionUser.role === 'admin') { %>
        <div class="hr"></div>
        <a href="/admin" class="item ajax-link <%= currentPath==='/admin'?'active':'' %>"><i class="fa fa-gauge"></i> Admin Dashboard</a>
        <a href="/admin/users" class="item ajax-link <%= currentPath==='/admin/users'?'active':'' %>"><i class="fa fa-users"></i> Manage Users</a>
        <a href="/admin/notifications" class="item ajax-link <%= currentPath==='/admin/notifications'?'active':'' %>"><i class="fa fa-inbox"></i> All Notifications</a>
        <a href="/admin/logins" class="item ajax-link <%= currentPath==='/admin/logins'?'active':'' %>"><i class="fa fa-right-to-bracket"></i> Login Logs</a>
        <a href="/admin/tweets" class="item ajax-link <%= currentPath==='/admin/tweets'?'active':'' %>"><i class="fab fa-twitter"></i> Tweet Logs</a>
        <a href="/admin/settings" class="item ajax-link <%= currentPath==='/admin/settings'?'active':'' %>"><i class="fa fa-wrench"></i> Admin Settings</a>
        <a href="/admin/wa-connect" class="item ajax-link <%= currentPath==='/admin/wa-connect'?'active':'' %>"><i class="fa fa-qrcode"></i> WhatsApp Connect</a>
      <% } %>
    </nav>
    <div class="foot">Â© <span id="y"></span> PansaGroup</div>
  </aside>

  <!-- Topbar -->
  <header class="topbar">
    <% if (twitterUser) { %>
      <div class="dropdown">
        <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" data-bs-toggle="dropdown">
          <img src="<%= twitterUser.profile_image_url %>" class="avatar me-2" alt="avatar">
          <strong>@<%= twitterUser.username %></strong>
        </a>
        <ul class="dropdown-menu dropdown-menu-end shadow">
          <li><a class="dropdown-item" href="/logout"><i class="fa fa-sign-out-alt me-2"></i> Logout</a></li>
        </ul>
      </div>
    <% } else { %>
      <a href="/logout" class="btn btn-outline-danger"><i class="fa fa-sign-out-alt"></i> Logout</a>
    <% } %>
  </header>

  <!-- Content -->
  <main class="content" id="content">
    <%- body %>
  </main>
</div>
<script>document.getElementById("y").textContent=new Date().getFullYear()</script>
<% } else { %>
  <%- body %>
<% } %>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/main.js"></script>

<% if (alert) { %>
<script>
Swal.fire({ icon:"<%= alert.type %>", title:"<%= alert.title %>", text:"<%= alert.message %>" });
</script>
<% } %>
</body>
</html>
